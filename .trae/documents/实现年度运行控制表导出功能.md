### 导出运行控制表功能优化方案

1. **需求分析**：
   用户需要导出与实际业务匹配的「第X年运行控制表」，用于记录**年初、4个季度、年末各操作步骤的完成情况**（每季度重复执行季度操作并打勾），需严格对齐原始表格的操作条目。

2. **表格结构设计**：

* 表头：第X年运行控制表
* 列结构：序号、操作名称、季度1（完成打勾）、季度2（完成打勾）、季度3（完成打勾）、季度4（完成打勾）
* 行结构（与原始表格操作完全匹配）：
  * 年初操作（4项）：
    1. 新年度规划会议
    2. 参加订货会/登记销售订单
    3. 制定新年度计划
    4. 支付应付税
  * 季度操作（20项，每个季度重复执行）：
    1. 季初现金盘点（请填写库存数量）
    2. 更新短贷/还本付息
    3. 申请短期贷款（高利贷）
    4. 更新应付账款/归还应付账款
    5. 原材料入库/更新原材料单
    6. 下原料订单
    7. 更新生产/完工入库
    8. 投资新生产线/变卖生产线/生产线转产
    9. 向其他企业购买原材料/出售原材料
    10. 开始下一批生产
    11. 更新应收账款/应收账款收现
    12. 出售厂房
    13. 向其他企业购买成品/出售成品
    14. 按订单交货
    15. 产品研发投资
    16. 支付行政管理费
    17. 其他现金收支情况登记
    18. 入库（收入）数量合计
    19. 出库（现金支出）合计
    20. 本季库存（现金）结余数量
  * 年末操作（6项）：
    1. 支付利息/更新长期贷款/申请长期贷款
    2. 支付设备维护费
    3. 支付租金/购买厂房
    4. 计提折旧
    5. 新市场开拓/ISO资格认证投资
    6. 结账

1. **实现步骤**：

* 在`OperationCenter.tsx`组件的操作区添加「导出运行控制表」按钮，绑定点击事件
* 创建`exportOperationControlTable`工具函数：
  1. 定义**完整操作步骤列表**（与上述行结构的操作名称完全对应）
  2. 构建CSV表头行：`["第X年运行控制表", "", "", "", "", ""]`、`["序号", "操作名称", "季度1", "季度2", "季度3", "季度4"]`
  3. 按「年初操作→季度1操作→季度2操作→季度3操作→季度4操作→年末操作」的顺序，生成每一行的CSV数据（序号自动递增）
* 实现CSV下载：将数据拼接为CSV格式字符串，通过Blob对象和`URL.createObjectURL`创建下载链接，触发浏览器下载

1. **技术实现细节**：

* 导出格式：采用CSV（逗号分隔），兼容Excel/Numbers等表格工具
* 数据拼接规则：
  * 表头行单独处理，保证「第X年运行控制表」跨列显示（CSV中通过空字符串占位）
  * 操作步骤的序号与操作名称严格对应原始表格
* 交互优化：导出时添加“导出中...”提示，下载完成后自动清除临时URL

1. **预期效果**：

* 点击按钮后，自动下载名为「第X年运行控制表.csv」的文件
* 用Excel打开后，表格结构与原始业务表一致：含年初/4季度/年末操作，4个季度列可直接打勾记录完成情况
* 操作名称、序号与原始表格完全匹配，无信息遗漏

  <br />

